---
sidebar_position: 2
description: π“ Docker Compose λ¥Ό μ΄μ©ν•΄ zookeeper μ™€ Kafka broker λ¥Ό λ„μ›λ΄…λ‹λ‹¤.
---

# 2) Producer & Consumer
import CodeDescription from '@site/src/components/CodeDescription';
import BrowserWindow from '@site/src/components/BrowserWindow';


### λ©ν‘

1. Docker Compose λ¥Ό μ΄μ©ν•΄ zookeeper μ™€ Kafka broker λ¥Ό λ„μ›λ΄…λ‹λ‹¤.
2. Producer μ™€ consumer λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
3. Producer μ—μ„ λ©”μ‹μ§€λ¥Ό μƒμ„±ν•κ³ , consumer μ—μ„ λ©”μ‹μ§€λ¥Ό ν™•μΈν•©λ‹λ‹¤.

<details>
<summary>μ¤ν™ λ…μ„Έμ„</summary>
<CodeDescription>

### μ¤ν™ λ…μ„Έμ„

1. Zookeeper μ™€ kafka broker λ¥Ό λ„μ°λ” `naive-docker-compose.yaml` νμΌμ„ μ‘μ„±ν•©λ‹λ‹¤.
    - Zookeeper
        - Service name : `zookeeper`
        - Image : `confluentinc/cp-zookeeper:7.3.0`
        - Container name : `zookeeper`
        - Port : `2181:2181`
        - Environment
            - `ZOOKEEPER_SERVER_ID` : `1`
            - `ZOOKEEPER_CLIENT_PORT` : `2181`
    - Broker
        - Service name : `broker`
        - Image : `confluentinc/cp-kafka:7.3.0`
        - Container name : `broker`
        - Port : `9092:9092`
        - Environment
            - `KAFKA_BROKER_ID` : `1`
            - `KAFKA_ZOOKEEPER_CONNECT` : `zookeeper:2181`
            - `KAFKA_ADVERTISED_LISTENERS` : `PLAINTEXT://broker:29092,PLAINTEXT_HOST://localhost:9092`
            - `KAFKA_LISTENER_SECURITY_PROTOCOL_MAP` : `PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT`
            - `KAFKA_INTER_BROKER_LISTENER_NAME` : `PLAINTEXT`
            - `KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR` : `1`
            - `KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS` : `0`
2. `naive-docker-compose.yaml` μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
3. `docker compose exec` λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•μ—¬ topic μ„ μƒμ„±ν•©λ‹λ‹¤.
    - Topic name : `topic-test`
    - Partition count : 1
    - Replication factor count : 1
4. ν„°λ―Έλ„μ—μ„ `docker compose exec` λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•μ—¬ broker μ— μ ‘μ†ν• λ’¤, `kafka-console-consumer` λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•μ—¬ consumer λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
    - Topic name : `topic-test`
    - Bootstrap server : `broker:29092`
5. λ‹¤λ¥Έ ν„°λ―Έλ„μ—μ„ `docker compose exec` λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•μ—¬ broker μ— μ ‘μ†ν• λ’¤, `kafka-console-producer` λ…λ Ήμ–΄λ¥Ό μ΄μ©ν•μ—¬ producer λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
    - Topic name : `topic-test`
    - Broker list : `broker:29092`
6. Producer μ—μ„ λ©”μ‹μ§€λ¥Ό μƒμ„±ν•κ³ , consumer μ—μ„ λ©”μ‹μ§€λ¥Ό ν™•μΈν•©λ‹λ‹¤.

</CodeDescription>
</details>

---

<BrowserWindow url="https://github.com/mlops-for-mle/mlops-for-mle/tree/main/ch7">

ν•΄λ‹Ή ννΈμ μ „μ²΄ μ½”λ“λ” [mlops-for-mle/ch7/](https://github.com/mlops-for-mle/mlops-for-mle/tree/main/ch7) μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

```js
ch7
β”β”€β”€ Makefile
β”β”€β”€ README.md
β”β”€β”€ connect.Dockerfile
β”β”€β”€ create_table.py
β”β”€β”€ kafka-docker-compose.yaml
// highlight-next-line
β”β”€β”€ naive-docker-compose.yaml
β”β”€β”€ sink_connector.json
β”β”€β”€ source_connector.json
β”β”€β”€ target-docker-compose.yaml
β””β”€β”€ target.Dockerfile
```

</BrowserWindow>

## 1. Zookeeper & Kafka Broker setup

Zookeeper μ™€ Kafka Broker λ¥Ό λ„μ°λ” `naive-docker-compose.yaml` νμΌμ„ μ‘μ„±ν•΄λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤.

### 1.1 Zookeeper service

λ¨Όμ €, Zookeeper service λ¥Ό λ„μΈ λ• μ“°μ΄λ” μ”μ†λ“¤μ— λ€ν•΄ μ•μ•„λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤.

<CodeDescription>

```yaml  title="naive-docker-compose.yaml"
version: "3"

services:
	zookeeper:
    image: confluentinc/cp-zookeeper:7.3.0
    container_name: zookeeper
    ports:
      - 2181:2181
    environment:
      ZOOKEEPER_SERVER_ID: 1
      ZOOKEEPER_CLIENT_PORT: 2181
```
- `image` : zookeeper μ imageλ΅ `confluentinc/cp-zookeeper:7.3.0` λ¥Ό μ΄μ©ν•λ„λ΅ ν•κ² μµλ‹λ‹¤.
- `container_name` : container μ μ΄λ¦„μ€ `zookeeper` λ΅ μ‚¬μ©ν•κ² μµλ‹λ‹¤.
- `ports` : zookeeperμ port μΈ `2181:2181` λ¥Ό ν¬νΈν¬μ›λ”©ν•©λ‹λ‹¤.

zookeeper μ ν™κ²½ λ³€μλ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

<CodeDescription>

- **ZOOKEEPER_SERVER_ID**
  - zookeeper cluster μ—μ„ ν•΄λ‹Ή zookeeper λ¥Ό μ‹λ³„ν•  ID λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” ID λ¥Ό 1λ΅ μ§€μ •ν•κ² μµλ‹λ‹¤.
- **ZOOKEEPER_CLIENT_PORT**
  - zookeeper client μ port λ¥Ό μ§€μ •ν•©λ‹λ‹¤. container λ‚΄λ¶€μ—μ„ zookeeper λ” μ§€μ •λ port λ΅ μ‹¤ν–‰λ©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” κΈ°λ³Έ zookeeper μ port μΈ `2181` λ΅ μ§€μ •ν•κ² μµλ‹λ‹¤.

</CodeDescription>

</CodeDescription>

### 1.2 Kafka Broker service

λ‹¤μμΌλ΅ Kafka Broker service λ¥Ό λ„μΈ λ• μ“°μ΄λ” μ”μ†λ“¤μ— λ€ν•΄ μ•μ•„λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤. μ΄λ² μ±•ν„°μ—μ„λ” single broker λ¥Ό κ°€μ •ν•κ³  μ‘μ„±ν•΄λ³΄κ² μµλ‹λ‹¤.

<CodeDescription>

```yaml  title="naive-docker-compose.yaml"
broker:
    image: confluentinc/cp-kafka:7.3.0
    container_name: broker
    depends_on:
      - zookeeper
    ports:
      - 9092:9092
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker:29092,PLAINTEXT_HOST://localhost:9092
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0
```

- `image` : broker μ imageλ΅ `confluentinc/cp-kafka:7.3.0` λ¥Ό μ΄μ©ν•λ„λ΅ ν•κ² μµλ‹λ‹¤.
- `container_name` : container μ μ΄λ¦„μ€ `broker` λ΅ μ‚¬μ©ν•κ² μµλ‹λ‹¤.
- `depends_on` : `zookeeper` κ°€ λ¨Όμ € μ‹¤ν–‰λ ν›„ λ‹¤μμ— broker κ°€ μ‹¤ν–‰λμ–΄μ•Ό ν•©λ‹λ‹¤.
- `ports` : broker μ port μΈ `9092:9092` λ¥Ό ν¬νΈν¬μ›λ”©ν•©λ‹λ‹¤.

Broker μ ν™κ²½ λ³€μλ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

<CodeDescription>

- **KAFKA_SERVER_ID**
  - broker μ ID λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
  - Single broker μ—μ„λ” μ—†μ–΄λ„ λ¬΄λ°©ν•λ‚ μ΄λ² μ±•ν„°μ—μ„λ” 1λ΅ μ§€μ •ν•κ² μµλ‹λ‹¤.
- **KAFKA_ZOOKEEPER_CONNECT**
  - Broker κ°€ zookeeper μ— connection ν•κΈ° μ„ν• μ£Όμ†λ¥Ό μ§€μ •ν•©λ‹λ‹¤.
  - μΌλ°μ μΌλ΅ `<zookeeper service name>:<zookeeper service port>` ν•μ‹μΌλ΅ μ‘μ„±ν•©λ‹λ‹¤.
  - μ•μ„ λ„μ΄ zookeeperμ nameκ³Ό portμΈ `zookeeper:2181` λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
- **KAFKA_ADVERTISED_LISTENERS**
  - λ‚΄λ¶€μ™€ μ™Έλ¶€μ—μ„ μ ‘μ†ν•κΈ° μ„ν• λ¦¬μ¤λ„λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.
  - μΌλ°μ μΌλ΅ internal κ³Ό external λ¥Ό κ°™μ΄ μ„¤μ •ν•λ©° `,` λ΅ μ—°κ²°ν•΄μ„ μ‘μ„±ν•©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” internal λ΅ `PLAINTEXT://broker:29092` λ΅ μ„¤μ •ν•κ³ , external λ΅ `PLAINTEXT_HOST://localhost:9092` μΌλ΅ μ„¤μ •ν•κ² μµλ‹λ‹¤.
    - μµμΆ…μ μΌλ΅ `PLAINTEXT://broker:29092,PLAINTEXT_HOST://localhost:9092` λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
- **KAFKA_LISTENER_SECURITY_PROTOCOL_MAP**
  - λ³΄μ•μ„ μ„ν• protocol mappingμ„ μ„¤μ •ν•©λ‹λ‹¤.
  - μ΄ μ„¤μ •κ°’μ€ `KAFKA_ADVERTISED_LISTENERS` κ³Ό ν•¨κ» key/value λ΅ λ§¤ν•‘λ©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” `PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT` λ΅ μ„¤μ •ν•κ² μµλ‹λ‹¤.
- **KAFKA_INTER_BROKER_LISTENER_NAME**
  - container λ‚΄λ¶€μ—μ„ μ‚¬μ©ν•  λ¦¬μ¤λ„ μ΄λ¦„μ„ μ§€μ •ν•©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” μ•μ„ internal λ΅ μ„¤μ •ν–λ `PLAINTEXT` λ¥Ό μ…λ ¥ν•©λ‹λ‹¤.
- **KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR**
  - topic μ„ λ¶„μ‚°ν•μ—¬ μ €μ¥ν•  replication factor λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.
  - κΈ°λ³Έκ°’μ€ 3μΌλ΅ μ„¤μ •ν•μ§€ μ•μΌλ©΄ μλ™μΌλ΅ multi brokerλ¥Ό κµ¬μ„±ν•©λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” single broker λ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ— `1`λ΅ μ§€μ •ν•κ² μµλ‹λ‹¤.<
- **KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS**
  - kafka cluster μ—μ„ μ΄κΈ°μ— rebalancing ν•  λ• consumer λ“¤μ΄ consumer group μ— μ΅°μΈν•  λ• λ€κΈ°ν•λ” μ‹κ°„μ…λ‹λ‹¤.
  - μ΄λ² μ±•ν„°μ—μ„λ” `0`μΌλ΅ μ„¤μ •ν•΄μ¤λ‹λ‹¤.

</CodeDescription>

</CodeDescription>


### 1.3 μ „μ²΄ μ½”λ“

μµμΆ…μ μΈ `naive-docker-compose.yaml` κµ¬μ„±μ€ μ•„λμ™€ κ°™μµλ‹λ‹¤.

```yaml  title="naive-docker-compose.yaml"
version: "3"

services:
  zookeeper:
    image: confluentinc/cp-zookeeper:7.3.0
    container_name: zookeeper
    ports:
      - 2181:2181
    environment:
      ZOOKEEPER_SERVER_ID: 1
      ZOOKEEPER_CLIENT_PORT: 2181
  broker:
    image: confluentinc/cp-kafka:7.3.0
    container_name: broker
    depends_on:
      - zookeeper
    ports:
      - 9092:9092
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker:29092,PLAINTEXT_HOST://localhost:9092
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0
```

### 1.4 μ‹¤ν–‰

μ•„λ λ…λ Ήμ–΄λ¥Ό ν™μ©ν•΄ μ •μλ μ„λΉ„μ¤λ¥Ό λ°±κ·ΈλΌμ΄λ“ ν”„λ΅μ„Έμ¤λ΅ λ„μ›λ‹λ‹¤.

```bash
# terminal-command
docker compose -p ch7-naive -f naive-docker-compose.yaml up -d
```

`docker ps` λ¥Ό μ…λ ¥ν•μ—¬ μ λ„μ›μ΅λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

```bash
# terminal-command
docker ps
CONTAINER ID   IMAGE                             COMMAND                  CREATED          STATUS          PORTS                                        NAMES
0a0599db4d96   confluentinc/cp-kafka:7.3.0       "/etc/confluent/dockβ€¦"   28 seconds ago   Up 27 seconds   0.0.0.0:9092->9092/tcp                       broker
35cdc624ac34   confluentinc/cp-zookeeper:7.3.0   "/etc/confluent/dockβ€¦"   28 seconds ago   Up 27 seconds   2888/tcp, 0.0.0.0:2181->2181/tcp, 3888/tcp   zookeeper
```

## 2. Producer & Consumer setup

μ΄λ²μ—λ” topic μ„ μƒμ„±ν•΄λ³΄κ³ , μ΄μ–΄μ„ producer μ™€ consumer λ¥Ό μƒμ„±ν•΄λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤.

### 2.1 Topic

#### 2.1.1 Topic μƒμ„±

μ΄μ  Topic μ„ μƒμ„±ν•΄λ³΄κ² μµλ‹λ‹¤.

<CodeDescription>

```bash
# terminal-command
docker compose exec broker kafka-topics --create --topic topic-test --bootstrap-server broker:29092 --partitions 1 --replication-factor 1
```

- `docker compose exec` : container λ‚΄μ— λ…λ Ήμ–΄λ¥Ό μν–‰ν•©λ‹λ‹¤.
- `broker` : μƒμ„±λ broker service μ μ΄λ¦„μ„ μ μµλ‹λ‹¤.
- `kafka-topics` : kafka topic μ— λ€ν• λ…λ Ήμ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
- `--create` : topic μ„ μƒμ„±ν•©λ‹λ‹¤.
- `--topic` : μƒμ„±ν•  topic μ μ΄λ¦„μ„ μ§€μ •ν•©λ‹λ‹¤. μ΄λ² μ±•ν„°μ—μ„λ” `topic-test` λΌλ” μ΄λ¦„μΌλ΅ μƒμ„±ν•΄λ³΄κ² μµλ‹λ‹¤.
- `--bootstrap-server` : broker service μ— λ€ν• hostname μ™€ port λ¥Ό  μ§€μ •ν•©λ‹λ‹¤. μ΄λ² μ±•ν„°μ—μ„λ” μ•μ„ docker-compose λ΅ λ„μ› λ broker μ ν™κ²½ λ³€μλ¥Ό μ°Έκ³ ν•μ—¬ `broker:29092` λ΅ μ„¤μ •ν•©λ‹λ‹¤.
- `--partition` : topic λ‚΄μ— partition κ°μλ¥Ό μ„¤μ •ν•©λ‹λ‹¤. μ΄λ² μ±•ν„°μ—μ„λ” 1λ΅ μ„¤μ •ν•κ² μµλ‹λ‹¤.
- `--replication-factor` : replication factor λ¥Ό μ§€μ •ν•©λ‹λ‹¤. μ΄λ² μ±•ν„°μ—μ„λ” 1λ΅ μ„¤μ •ν•κ² μµλ‹λ‹¤.

</CodeDescription>

#### 2.1.1 Topic μƒμ„± ν™•μΈ
μ΄μ–΄μ„ topic μ΄ μ μƒμ„±λμ—λ”μ§€ ν™•μΈν•΄λ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤.

<CodeDescription>

```bash
# terminal-command
docker compose exec broker kafka-topics --describe --topic topic-test --bootstrap-server broker:29092
```

- `--describe` :  μƒμ„±λ topic μ— λ€ν• μƒμ„Έ μ„¤λ…μ„ λ³΄μ—¬μ¤λ‹λ‹¤.

</CodeDescription>

μ‹¤ν–‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ μ¶λ ¥λ©λ‹λ‹¤.

```bash
Topic: topic-test       TopicId: pcR8cByuSVG1p1guQ3MFRg PartitionCount: 1       ReplicationFactor: 1   Configs: 
        Topic: topic-test       Partition: 0    Leader: 1       Replicas: 1     Isr: 1
```

μ„μ—μ„ μ…λ ¥ν• `topic-test` κ°€ μƒμ„±λ κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

### 2.2 Consumer

μ΄μ  topic μ„ μƒμ„±ν–μΌλ‹ μƒμ„±ν• topic μ„ μ‚¬μ©ν•  consumer λ¥Ό λ§λ“¤μ–΄ λ³΄κ² μµλ‹λ‹¤.  
Consumer λ¥Ό λ¨Όμ € μ‹¤ν–‰ν•λ” μ΄μ λ” μΌλ°μ μΌλ΅ consumer κ°€ λ©”μ‹μ§€λ¥Ό subscribe ν•λ ¤κ³  λ€κΈ°ν•λ” μƒνƒμ—μ„ producer κ°€ λ©”μ‹μ§€λ¥Ό μƒμ„±ν•΄μ„ λ³΄λ‚΄κΈ° λ•λ¬Έμ…λ‹λ‹¤.

#### 2.2.1 Kafka Container μ ‘μ†
λ¨Όμ € `docker compose exec` λ…λ Ήμ–΄λ¥Ό ν†µν•΄ μ»¨ν…μ΄λ„ λ‚΄λ¶€λ΅ μ ‘μ†ν•©λ‹λ‹¤.

```bash
# terminal 1
# terminal-command
docker compose -p ch7-naive exec broker /bin/bash
```

μ»¨ν…μ΄λ„μ— μ ‘μ†ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ ν„°λ―Έλ„μ΄ μ—΄λ¦½λ‹λ‹¤.

```bash
# terminal-command
[appuser@0a0599db4d96 ~]$
```

#### 2.2.2 Counsumer μ‹¤ν–‰
μ΄ν›„μ— `kafka-console-consumer` λ¥Ό μ΄μ©ν•μ—¬ `topic-test` topic μ„ subscribe ν•©λ‹λ‹¤.

<CodeDescription>

```bash  title="[appuser@0a0599db4d96 ~]$"
# terminal-command
kafka-console-consumer --topic topic-test --bootstrap-server broker:29092
```
- Topic μ„ μƒμ„±ν–λ κ²ƒμ²λΌ bootstrap-server λ¥Ό `broker:29092` λ΅ μ„¤μ •ν•©λ‹λ‹¤.

</CodeDescription>

μ‹¤ν–‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ μμ‹ μ„ λ€κΈ°ν•κ³  μλ” μƒνƒκ°€ λ©λ‹λ‹¤.

```bash
[appuser@0a0599db4d96 ~]$ kafka-console-consumer --topic topic-test --bootstrap-server broker:29092

```

### 2.3 Producer
λ§μ§€λ§‰μΌλ΅ producer λ¥Ό λ§λ“¤μ–΄μ„ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Ό μ¤€λΉ„λ¥Ό ν•κ² μµλ‹λ‹¤.

#### 2.3.1 Kafka Container μ ‘μ†

Consumer μ™€ λ‘κ°™μ΄, `docker compose exec` λ…λ Ήμ–΄λ¥Ό ν†µν•΄ container λ‚΄λ¶€λ΅ μ ‘μ†ν•©λ‹λ‹¤. 

:::caution

μ΄ λ• consumer λ¥Ό μ‹¤ν–‰ν–λ terminal μ΄ μ•„λ‹ μƒλ΅μ΄ terminal λ΅ λ„μ›λ‹λ‹¤.

:::


```bash
# terminal 2
# terminal-command
docker compose -p ch7-naive exec broker /bin/bash
```

μ ‘μ†λλ©΄ λ‹¤μκ³Ό κ°™μ΄ ν„°λ―Έλ„μ΄ μ—΄λ¦½λ‹λ‹¤.

```bash
# terminal-command
[appuser@0a0599db4d96 ~]$ 
```

#### 2.3.2 Producer μ‹¤ν–‰

μ΄ν›„μ— `kafka-console-producer` λ¥Ό μ΄μ©ν•μ—¬ `topic-test` topic μ— μ ‘κ·Όν•μ—¬ publish ν•  μ¤€λΉ„λ¥Ό ν•©λ‹λ‹¤.

```bash  title="[appuser@0a0599db4d96 ~]$ "
# terminal-command
kafka-console-producer --topic topic-test --broker-list broker:29092
```

λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ publish ν•  μ μλ” μƒνƒκ°€ λ©λ‹λ‹¤.

```bash
[appuser@0a0599db4d96 ~]$ kafka-console-producer --topic topic-test --broker-list broker:29092
> 
```

### 2.4 Communicate

![communicate](./img/kafka-gif-1.gif)
#### 2.4.1 Producer μ— λ©”μ‹μ§€ μ…λ ¥ν•κΈ°

Producer κ°€ μ—΄λ ¤ μλ” λ‘ λ²μ§Έ ν„°λ―Έλ„μ—μ„ μ•„λμ™€ κ°™μ΄ `hello`, `this is mlops for mle` λ¥Ό μ…λ ¥ν•΄λ΄…λ‹λ‹¤.

```bash
[appuser@0a0599db4d96 ~]$ kafka-console-producer --topic topic-test --broker-list broker:29092
> hello
> this is mlops for mle
```

#### 2.4.2 Conumer μ—μ„ λ©”μ‹μ§€ κ²°κ³Ό λ³΄κΈ°

Consumer μ—μ„ μ•„λμ λ©”μ‹μ§€κ°€ μ „λ‹¬λ¨μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

```bash
hello
this is mlops for mle
```

### 2.5 μΆ…λ£
λ¨λ“  κ³Όμ •μ΄ μΆ…λ£λμ—μΌλ©΄ zookeeper μ™€ broker λ¥Ό μΆ…λ£ν•©λ‹λ‹¤.

```bash
# terminal-command
docker compose -p ch7-naive down -v
```
