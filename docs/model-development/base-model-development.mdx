---
sidebar_position: 1
description: ğŸ“Œ ëª¨ë¸ì„ í•™ìŠµí•˜ê³  ì €ì¥í•˜ëŠ” ê¸°ë³¸ì ì¸ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•©ë‹ˆë‹¤.
---

# 1) Base Model Development
import CodeDescription from '@site/src/components/CodeDescription';
import PreviewDescription from '@site/src/components/PreviewDescription';
import BrowserWindow from '@site/src/components/BrowserWindow';
import { Chapter, Part } from '@site/src/components/Highlight';
import ModelDevelopmentImage1 from './img/model-development-1.png';

## Chapter Preview
---
### ëª©í‘œ

1. ëª¨ë¸ì„ í•™ìŠµí•˜ê³  ì €ì¥í•˜ëŠ” ê¸°ë³¸ì ì¸ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•©ë‹ˆë‹¤.

### ìŠ¤í™ ëª…ì„¸ì„œ

1. í•™ìŠµ ë° í‰ê°€ ë°ì´í„° ì„ ì •
    - `scikit-learn` ì—ì„œ ì œê³µí•˜ëŠ” iris ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
    - ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ í•™ìŠµ ë°ì´í„°ì™€ í‰ê°€ ë°ì´í„°ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.
    - ì´ ë•Œ ë¶„ë¦¬ëœ ë°ì´í„°ëŠ” ì¶”í›„ì— ì¬í˜„ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
2. ëª¨ë¸ ê°œë°œ ë° í•™ìŠµ
    - `scikit-learn` ì—ì„œ ì œê³µí•˜ëŠ” Standard Scaler ì™€ SVCë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - `1. í•™ìŠµ ë° í‰ê°€ ë°ì´í„° ì„ ì •` ì—ì„œ ë‚˜ëˆˆ í•™ìŠµ ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤.
    - í•™ìŠµëœ ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ í•™ìŠµ ë°ì´í„°ì™€ í‰ê°€ ë°ì´í„°ì˜ ì •í™•ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
3. í•™ìŠµëœ ëª¨ë¸ ì €ì¥
    - í•™ìŠµëœ ëª¨ë¸ì„ `joblib` , `pickle` , `dill` ë“±ì˜ íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•´ ì €ì¥í•©ë‹ˆë‹¤.
4. ì €ì¥ëœ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°
    - ëª¨ë¸ì´ ì •ìƒì ìœ¼ë¡œ ì €ì¥ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
    - ë¶ˆëŸ¬ì˜¨ ëª¨ë¸ë¡œ í•™ìŠµ ë°ì´í„°ì™€ í‰ê°€ ë°ì´í„°ì˜ ì •í™•ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    - `1. í•™ìŠµ ë° í‰ê°€ ë°ì´í„° ì„ ì •` ì—ì„œ ë‚˜ëˆˆ Validation ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ í•™ìŠµì´ ì˜ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

</PreviewDescription>

<BrowserWindow url="https://github.com/mlops-for-mle/mlops-for-mle/tree/main/ch2">

í•´ë‹¹ íŒŒíŠ¸ì˜ ì „ì²´ ì½”ë“œëŠ” [mlops-for-mle/ch2/](https://github.com/mlops-for-mle/mlops-for-mle/tree/main/ch2) ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
ch2
â”œâ”€â”€ Makefile
â”œâ”€â”€ README.md
// highlight-next-line
â”œâ”€â”€ base_train.py
// highlight-next-line
â”œâ”€â”€ base_validate_save_model.py
â”œâ”€â”€ db_train.py
â”œâ”€â”€ db_validate_save_model.py
â”œâ”€â”€ pipeline_train.py
â””â”€â”€ pipeline_validate_save_model.py
```

</BrowserWindow>

<div style={{textAlign: 'center'}}>

<img src={ModelDevelopmentImage1} style={{scale: '80%'}}/>

[ê·¸ë¦¼ 2-3] Basic Workflow
</div>

## 0. íŒ¨í‚¤ì§€ ì„¤ì¹˜

ì´ë²ˆ ì±•í„°ì—ì„œ ì‚¬ìš©í•  íŒ¨í‚¤ì§€ë“¤ì¸ `pandas`, `scikit-learn`, `joblib` ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
# terminal-command
pip install pandas scikit-learn joblib
```

## 1. í•™ìŠµ ë° í‰ê°€ ë°ì´í„° ì„ ì •

`sklearn.datasets` ì—ì„œ `load_iris` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ iris ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

```python
from sklearn.datasets import load_iris

X, y = load_iris(return_X_y=True, as_frame=True)
```

ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ ê°ê° `X`, `y` ì— í• ë‹¹í•©ë‹ˆë‹¤.

`sklearn.model_selection` ì˜ `train_test_split` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë°ì´í„°ë¥¼ í•™ìŠµ ë° í‰ê°€ ë°ì´í„°ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤. ë˜í•œ ì¶”í›„ì— ì¬í˜„í•  ìˆ˜ ìˆë„ë¡ `random_seed` ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.

```python
from sklearn.model_selection import train_test_split

X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=0.8, random_state=2022)
```

ë¶„ë¦¬ëœ ë°ì´í„°ì—ì„œ í•™ìŠµ ë°ì´í„°ë¥¼ `X_train`, `y_train` ì— í• ë‹¹í•˜ê³ , í‰ê°€ ë°ì´í„°ëŠ” `X_valid`, `y_valid` ì— í• ë‹¹í•©ë‹ˆë‹¤.

## 2. ëª¨ë¸ ê°œë°œ ë° í•™ìŠµ
ë°ì´í„°ë¥¼ scaling í•˜ê¸° ìœ„í•´ `sklearn.preprocessing` ì˜ `StandardScaler` ë¥¼ `scaler` ì— í• ë‹¹í•©ë‹ˆë‹¤.

```python
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
```

`fit` ì„ í†µí•´ scalerë¥¼ í•™ìŠµí•œ í›„ `transform`ì„ ì´ìš©í•´ ë°ì´í„°ë¥¼ scaling í•©ë‹ˆë‹¤.

```python
scaled_X_train = scaler.fit_transform(X_train)
scaled_X_valid = scaler.transform(X_valid)
```

scaling ì „ ë°ì´í„°ì™€ scaling í›„ ë°ì´í„°ë¥¼ ë¹„êµí•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
print(X_train.values[0])
print(scaled_X_train[0])
# [4.4 3.  1.3 0.2]
# [-1.71687346 -0.1513372  -1.37527528 -1.29070478]
```

ì´ì œ ëª¨ë¸ì„ í•™ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤. ì‚¬ìš©í•  ëª¨ë¸ì¸ `sklearn.svm` ì˜ `SVC` ë¥¼ `classifier` ì— í• ë‹¹í•©ë‹ˆë‹¤.

```python
from sklearn.svm import SVC

classifier = SVC()
```

`fit` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. ì´ ë•Œ ë°ì´í„°ëŠ” scaling ëœ ë°ì´í„°ì¸ `scaled_X_train` ê³¼ `y_train`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.


```python
classifier.fit(scaled_X_train, y_train)
```

`predict` í•¨ìˆ˜ë¥¼ í†µí•´ ì£¼ì–´ì§„ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ê°’ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ SVC ë¥¼ scaling ì´ ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— `scaled_X_train` ê³¼ `scaled_X_valid` ë¥¼ í†µí•´ ì˜ˆì¸¡ì„ í•´ì•¼ í•©ë‹ˆë‹¤.

```python
train_pred = classifier.predict(scaled_X_train)
valid_pred = classifier.predict(scaled_X_valid)
```

í•™ìŠµ ë°ì´í„°ì™€ í‰ê°€ ë°ì´í„°ì— ëŒ€í•´ì„œ ì˜ˆì¸¡ì„ ì§„í–‰í•˜ì—¬ ê°ê° `train_pred` ì™€ `valid_pred` ì— í• ë‹¹í•©ë‹ˆë‹¤.

ì´ì œ ì •í™•ë„ë¥¼ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ì •í™•ë„ëŠ” `sklearn.metrics` ì—ì„œ ì œê³µí•˜ëŠ” `accuracy_score` ë¥¼ ì´ìš©í•˜ì—¬ ê³„ì‚°í•´ ë³´ê² ìŠµë‹ˆë‹¤.

```python
from sklearn.metrics import accuracy_score

train_acc = accuracy_score(y_true=y_train, y_pred=train_pred)
valid_acc = accuracy_score(y_true=y_valid, y_pred=valid_pred)
```

ê³„ì‚°ëœ ì •í™•ë„ë¥¼ ì¶œë ¥í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```python
print("Train Accuracy :", train_acc)
print("Valid Accuracy :", valid_acc)
# Train Accuracy : 0.9833333333333333
# Valid Accuracy : 0.9666666666666667
```

ë§Œì•½ scaling ë˜ê¸° ì „ì¸ ì›ë³¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì–´ë–»ê²Œ ë‚˜ì˜¬ê¹Œìš”?

```python
train_pred = classifier.predict(X_train)
valid_pred = classifier.predict(X_valid)

train_acc = accuracy_score(y_true=y_train, y_pred=train_pred)
valid_acc = accuracy_score(y_true=y_valid, y_pred=valid_pred)

print("Train Accuracy :", train_acc)
print("Valid Accuracy :", valid_acc)
# Train Accuracy : 0.23333333333333334
# Valid Accuracy : 0.23333333333333334
```

ìœ„ì˜ ê²°ê³¼ì²˜ëŸ¼ ëª¨ë¸ì´ ì œëŒ€ë¡œ ì˜ˆì¸¡í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ì´ ë•Œë¬¸ì— í•™ìŠµëœ ëª¨ë¸ì´ ì •ìƒì ìœ¼ë¡œ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ì„œëŠ” ë°ì´í„°ë¥¼ ë³€í™˜í•  ë•Œ ì‚¬ìš©í•œ scaler ë„ ê°™ì´ ì €ì¥ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

## 3. í•™ìŠµëœ ëª¨ë¸ ì €ì¥

sickit-learn ì—ì„œ ê³µì‹ì ìœ¼ë¡œ ê¶Œì¥í•˜ëŠ” ëª¨ë¸ ì €ì¥ ë°©ë²•ì€ `joblib` íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. [[Scikit-Learn Model Presistence](https://scikit-learn.org/stable/model_persistence.html)]

```python
import joblib

joblib.dump(scaler, "scaler.joblib")
joblib.dump(classifier, "classifier.joblib")
```

ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ê²½ë¡œì— `scaler.joblib` ì™€ `classifier.joblib` íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

## 4. ì €ì¥ëœ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°

ëª¨ë¸ì´ ì •ìƒì ìœ¼ë¡œ ì €ì¥ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
ìš°ì„ , í•™ìŠµí•  ë•Œ ë‚˜ëˆˆ ë°ì´í„°ë¥¼ ë˜‘ê°™ì´ ì¬í˜„í•©ë‹ˆë‹¤.

```python
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

X, y = load_iris(return_X_y=True, as_frame=True)
X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=0.8, random_state=2022)
```

ë‹¤ìŒìœ¼ë¡œ ì €ì¥ëœ ëª¨ë¸ë“¤ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
```python
import joblib

scaler_load = joblib.load("scaler.joblib")
classifier_load = joblib.load("classifier.joblib")
```

ì´ì œ ë¶ˆëŸ¬ì˜¨ ëª¨ë¸ì„ í†µí•´ í•™ìŠµ ë° í‰ê°€ ë°ì´í„°ë¥¼ ì˜ˆì¸¡ì„ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.
ìš°ì„  ë°ì´í„°ë¥¼ scaler ë¥¼ í†µí•´ scaling ì„ í•©ë‹ˆë‹¤.

```python
scaled_X_train = scaler_load.transform(X_train)
scaled_X_valid = scaler_load.transform(X_valid)
```

ê·¸ë¦¬ê³  ëª¨ë¸ì„ í†µí•´ ì˜ˆì¸¡ì„ ì§„í–‰í•©ë‹ˆë‹¤.
```python
load_train_pred = classifier_load.predict(scaled_X_train)
load_valid_pred = classifier_load.predict(scaled_X_valid)
```

ì •í™•ë„ë¥¼ ê³„ì‚° í›„ ë¶ˆëŸ¬ì˜¤ê¸° ì „ ëª¨ë¸ê³¼ ì •í™•ë„ê°€ ê°™ì€ì§€ ë¹„êµí•©ë‹ˆë‹¤.

```python
from sklearn.metrics import accuracy_score

load_train_acc = accuracy_score(y_true=y_train, y_pred=load_train_pred)
load_valid_acc = accuracy_score(y_true=y_valid, y_pred=load_valid_pred)
```

ê³„ì‚°ëœ ì •í™•ë„ë¥¼ ì¶œë ¥í•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```python
print("Load Model Train Accuracy :", load_train_acc)
print("Load Model Valid Accuracy :", load_valid_acc)
# Train Accuracy : 0.9833333333333333
# Valid Accuracy : 0.9666666666666667
```

ìœ„ì—ì„œ ì‹¤í–‰í•œ ê²°ê³¼ì™€ ê°™ì€ ê²°ê³¼ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 5. ì „ì²´ ì½”ë“œ

ìœ„ì—ì„œ ì„¤ëª…í•œ ì½”ë“œë¥¼ `base_train.py`, `base_validate_save_model.py`  ë¡œ ë‚˜ëˆ ì„œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 5.1 `base_train.py`

ìš°ì„  í•™ìŠµ ë° ë°ì´í„° ì €ì¥ì„ ìœ„í•œ ì½”ë“œë“¤ì„ ëª¨ì€ `base_train.py` ì…ë‹ˆë‹¤.

```python  title="base_train.py"
# base_train.py
import joblib
from sklearn.datasets import load_iris
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.svm import SVC

# 1. get data
X, y = load_iris(return_X_y=True, as_frame=True)
X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=0.8, random_state=2022)

# 2. model development and train
scaler = StandardScaler()
classifier = SVC()

scaled_X_train = scaler.fit_transform(X_train)
scaled_X_valid = scaler.transform(X_valid)
classifier.fit(scaled_X_train, y_train)

train_pred = classifier.predict(scaled_X_train)
valid_pred = classifier.predict(scaled_X_valid)

train_acc = accuracy_score(y_true=y_train, y_pred=train_pred)
valid_acc = accuracy_score(y_true=y_valid, y_pred=valid_pred)

print("Train Accuracy :", train_acc)
print("Valid Accuracy :", valid_acc)

# 3. save model
joblib.dump(scaler, "scaler.joblib")
joblib.dump(classifier, "classifier.joblib")
```

### 5.2 `base_validate_save_model.py`

ë‹¤ìŒì€ ì €ì¥ëœ ëª¨ë¸ì„ ê²€ì¦í•˜ëŠ” `base_validate_save_model.py` ì…ë‹ˆë‹¤.

```python  title="base_validate_save_model.py"
# base_validate_save_model.py

import joblib
from sklearn.datasets import load_iris
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split

# 1. reproduce data
X, y = load_iris(return_X_y=True, as_frame=True)
X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=0.8, random_state=2022)

# 2. load model
scaler_load = joblib.load("scaler.joblib")
classifier_load = joblib.load("classifier.joblib")

# 3. validate
scaled_X_train = scaler_load.transform(X_train)
scaled_X_valid = scaler_load.transform(X_valid)

load_train_pred = classifier_load.predict(scaled_X_train)
load_valid_pred = classifier_load.predict(scaled_X_valid)

load_train_acc = accuracy_score(y_true=y_train, y_pred=load_train_pred)
load_valid_acc = accuracy_score(y_true=y_valid, y_pred=load_valid_pred)

print("Load Model Train Accuracy :", load_train_acc)
print("Load Model Valid Accuracy :", load_valid_acc)
```
